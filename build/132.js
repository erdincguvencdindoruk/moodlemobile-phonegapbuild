webpackJsonp([132],{2098:function(n,e,l){"use strict";function t(n){return g._42(0,[(n()(),g._16(0,0,null,null,1,"ion-icon",[["name","funnel"],["role","img"]],[[2,"hide",null]],null,null,null,null)),g._15(1,147456,null,0,ln.a,[tn.a,g.p,g.K],{name:[0,"name"]},null)],function(n,e){n(e,1,0,"funnel")},function(n,e){n(e,0,0,g._29(e,1)._hidden)})}function i(n){return g._42(0,[(n()(),g._16(0,0,null,null,1,"ion-icon",[["name","ios-funnel-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),g._15(1,147456,null,0,ln.a,[tn.a,g.p,g.K],{name:[0,"name"]},null)],function(n,e){n(e,1,0,"ios-funnel-outline")},function(n,e){n(e,0,0,g._29(e,1)._hidden)})}function a(n){return g._42(0,[(n()(),g._16(0,0,null,null,9,"button",[["icon-only",""],["ion-button",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.openCourseFilter(l)&&t}return t},an.b,an.a)),g._15(1,1097728,[[3,4]],0,un.a,[[8,""],tn.a,g.p,g.K],null,null),g._32(131072,rn.a,[on.a,g.i]),(n()(),g._40(-1,0,["\n                "])),(n()(),g._11(16777216,null,0,1,null,t)),g._15(5,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,0,["\n                "])),(n()(),g._11(16777216,null,0,1,null,i)),g._15(8,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,0,["\n            "]))],function(n,e){var l=e.component;n(e,5,0,l.courseId);n(e,8,0,!l.courseId)},function(n,e){n(e,0,0,g._41(e,0,0,g._29(e,2).transform("core.courses.filter")))})}function u(n){return g._42(0,[(n()(),g._16(0,0,null,null,8,"ion-card",[["class","core-warning-card"],["icon-start",""]],null,null,null,null,null)),g._15(1,16384,null,0,cn.a,[tn.a,g.p,g.K],null,null),(n()(),g._40(-1,null,["\n                "])),(n()(),g._16(3,0,null,null,1,"ion-icon",[["name","warning"],["role","img"]],[[2,"hide",null]],null,null,null,null)),g._15(4,147456,null,0,ln.a,[tn.a,g.p,g.K],{name:[0,"name"]},null),(n()(),g._40(5,null,[" ","\n            "])),g._32(131072,rn.a,[on.a,g.i]),g._33(7,{$a:0}),g._32(131072,rn.a,[on.a,g.i])],function(n,e){n(e,4,0,"warning")},function(n,e){n(e,3,0,g._29(e,4)._hidden);n(e,5,0,g._41(e,5,0,g._29(e,8).transform("core.hasdatatosync",n(e,7,0,g._41(e,5,0,g._29(e,6).transform("addon.calendar.calendar"))))))})}function r(n){return g._42(0,[(n()(),g._16(0,0,null,null,3,"core-empty-box",[["icon","calendar"]],null,null,null,dn.b,dn.a)),g._15(1,49152,null,0,_n.a,[],{message:[0,"message"],icon:[1,"icon"]},null),g._32(131072,rn.a,[on.a,g.i]),(n()(),g._40(-1,0,["\n            "]))],function(n,e){n(e,1,0,g._41(e,1,0,g._29(e,2).transform("addon.calendar.noevents")),"calendar")},null)}function o(n){return g._42(0,[(n()(),g._16(0,0,null,null,7,"ion-item-divider",[["class","item item-divider"]],null,null,null,fn.b,fn.a)),g._15(1,1097728,null,3,hn.a,[vn.a,tn.a,g.p,g.K,[2,pn.a]],null,null),g._37(335544320,4,{contentLabel:0}),g._37(603979776,5,{_buttons:1}),g._37(603979776,6,{_icons:1}),g._15(5,16384,null,0,mn.a,[tn.a,g.p,g.K],null,null),(n()(),g._40(6,2,["\n                        ","\n                    "])),g._34(7,2)],null,function(n,e){n(e,6,0,g._41(e,6,0,n(e,7,0,g._29(e.parent.parent.parent,0),1e3*e.parent.context.$implicit.timestart,"strftimedayshort")))})}function s(n){return g._42(0,[(n()(),g._16(0,0,null,null,0,"img",[["class","core-module-icon"],["item-start",""]],[[8,"src",4]],null,null,null,null))],null,function(n,e){n(e,0,0,g._19(1,"",e.parent.context.$implicit.moduleIcon,""))})}function c(n){return g._42(0,[(n()(),g._16(0,0,null,null,1,"core-icon",[["item-start",""]],null,null,null,En.b,En.a)),g._15(1,704512,null,0,gn.a,[g.p,tn.a],{name:[0,"name"]},null)],function(n,e){n(e,1,0,e.parent.context.$implicit.icon)},null)}function d(n){return g._42(0,[(n()(),g._16(0,0,null,null,2,"span",[],null,null,null,null,null)),(n()(),g._40(1,null,[" - ",""])),g._34(2,2)],null,function(n,e){n(e,1,0,g._41(e,1,0,n(e,2,0,g._29(e.parent.parent.parent,0),1e3*(e.parent.context.$implicit.timestart+e.parent.context.$implicit.timeduration),"strftimetime")))})}function _(n){return g._42(0,[(n()(),g._16(0,0,null,null,2,"span",[],null,null,null,null,null)),(n()(),g._40(1,null,[" - ",""])),g._34(2,2)],null,function(n,e){n(e,1,0,g._41(e,1,0,n(e,2,0,g._29(e.parent.parent.parent,0),1e3*(e.parent.context.$implicit.timestart+e.parent.context.$implicit.timeduration),"strftimedatetimeshort")))})}function f(n){return g._42(0,[(n()(),g._16(0,0,null,null,9,"ion-note",[["item-end",""]],null,null,null,null,null)),g._15(1,16384,null,0,In.a,[tn.a,g.p,g.K],null,null),(n()(),g._40(-1,null,["\n                            "])),(n()(),g._16(3,0,null,null,1,"ion-icon",[["name","time"],["role","img"]],[[2,"hide",null]],null,null,null,null)),g._15(4,147456,null,0,ln.a,[tn.a,g.p,g.K],{name:[0,"name"]},null),(n()(),g._40(-1,null,["\n                            "])),(n()(),g._16(6,0,null,null,2,"span",[["text-wrap",""]],null,null,null,null,null)),(n()(),g._40(7,null,["",""])),g._32(131072,rn.a,[on.a,g.i]),(n()(),g._40(-1,null,["\n                        "]))],function(n,e){n(e,4,0,"time")},function(n,e){n(e,3,0,g._29(e,4)._hidden);n(e,7,0,g._41(e,7,0,g._29(e,8).transform("core.notsent")))})}function h(n){return g._42(0,[(n()(),g._16(0,0,null,null,9,"ion-note",[["item-end",""]],null,null,null,null,null)),g._15(1,16384,null,0,In.a,[tn.a,g.p,g.K],null,null),(n()(),g._40(-1,null,["\n                            "])),(n()(),g._16(3,0,null,null,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),g._15(4,147456,null,0,ln.a,[tn.a,g.p,g.K],{name:[0,"name"]},null),(n()(),g._40(-1,null,["\n                            "])),(n()(),g._16(6,0,null,null,2,"span",[["text-wrap",""]],null,null,null,null,null)),(n()(),g._40(7,null,["",""])),g._32(131072,rn.a,[on.a,g.i]),(n()(),g._40(-1,null,["\n                        "]))],function(n,e){n(e,4,0,"trash")},function(n,e){n(e,3,0,g._29(e,4)._hidden);n(e,7,0,g._41(e,7,0,g._29(e,8).transform("core.deletedoffline")))})}function v(n){return g._42(0,[(n()(),g._16(0,0,null,null,40,null,null,null,null,null,null,null)),(n()(),g._40(-1,null,["\n                    "])),(n()(),g._11(16777216,null,null,1,null,o)),g._15(3,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,null,["\n                    "])),(n()(),g._16(5,0,null,null,34,"a",[["class","addon-calendar-event item item-block"],["ion-item",""],["text-wrap",""]],[[8,"title",0],[2,"core-split-item-selected",null]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.gotoEvent(n.context.$implicit.id)&&t}return t},fn.b,fn.a)),g._15(6,278528,null,0,sn.i,[g.v,g.w,g.p,g.L],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),g._31(7,1),g._15(8,1097728,null,3,hn.a,[vn.a,tn.a,g.p,g.K,[2,pn.a]],null,null),g._37(335544320,7,{contentLabel:0}),g._37(603979776,8,{_buttons:1}),g._37(603979776,9,{_icons:1}),g._15(12,16384,null,0,bn.a,[],null,null),(n()(),g._40(-1,2,["\n                        "])),(n()(),g._11(16777216,null,0,1,null,s)),g._15(15,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,2,["\n                        "])),(n()(),g._11(16777216,null,0,1,null,c)),g._15(18,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,2,["\n                        "])),(n()(),g._16(20,0,null,2,2,"h2",[],null,null,null,null,null)),(n()(),g._16(21,0,null,null,1,"core-format-text",[],null,null,null,null,null)),g._15(22,540672,null,0,yn.a,[g.p,N.a,S.a,On.a,on.a,Cn.a,k.a,Dn.a,Tn.a,xn.a,K.a,wn.a,[2,Ln.a],[2,Sn.a],[2,W.a],An.a,$.a],{text:[0,"text"]},null),(n()(),g._40(-1,2,["\n                        "])),(n()(),g._16(24,0,null,2,8,"p",[],null,null,null,null,null)),(n()(),g._40(25,null,["\n                            ","\n                            "])),g._34(26,2),(n()(),g._11(16777216,null,null,1,null,d)),g._15(28,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,null,["\n                            "])),(n()(),g._11(16777216,null,null,1,null,_)),g._15(31,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,null,["\n                        "])),(n()(),g._40(-1,2,["\n                        "])),(n()(),g._11(16777216,null,4,1,null,f)),g._15(35,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,2,["\n                        "])),(n()(),g._11(16777216,null,4,1,null,h)),g._15(38,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,2,["\n                    "])),(n()(),g._40(-1,null,["\n                "]))],function(n,e){n(e,3,0,e.context.$implicit.showDate);n(e,6,0,"addon-calendar-event",n(e,7,0,"addon-calendar-eventtype-"+e.context.$implicit.eventtype));n(e,15,0,e.context.$implicit.moduleIcon);n(e,18,0,e.context.$implicit.icon&&!e.context.$implicit.moduleIcon);n(e,22,0,e.context.$implicit.name);n(e,28,0,e.context.$implicit.timeduration&&e.context.$implicit.endsSameDay);n(e,31,0,e.context.$implicit.timeduration&&!e.context.$implicit.endsSameDay);n(e,35,0,e.context.$implicit.offline&&!e.context.$implicit.deleted);n(e,38,0,e.context.$implicit.deleted)},function(n,e){n(e,5,0,e.context.$implicit.name,e.context.$implicit.id==e.component.eventId);n(e,25,0,g._41(e,25,0,n(e,26,0,g._29(e.parent.parent,0),1e3*e.context.$implicit.timestart,"strftimetime")))})}function p(n){return g._42(0,[(n()(),g._16(0,0,null,null,5,"ion-list",[["no-margin",""]],null,null,null,null,null)),g._15(1,16384,null,0,kn.a,[tn.a,g.p,g.K,Cn.a,Nn.l,Pn.a],null,null),(n()(),g._40(-1,null,["\n                "])),(n()(),g._11(16777216,null,null,1,null,v)),g._15(4,802816,null,0,sn.j,[g.W,g.T,g.v],{ngForOf:[0,"ngForOf"]},null),(n()(),g._40(-1,null,["\n            "]))],function(n,e){n(e,4,0,e.component.filteredEvents)},null)}function m(n){return g._42(0,[(n()(),g._16(0,0,null,null,13,"ion-fab",[["bottom",""],["core-fab",""],["end",""]],null,null,null,$n.b,$n.a)),g._15(1,212992,null,0,Kn.a,[g.p,Sn.a],null,null),g._15(2,1228800,null,2,Wn.a,[Cn.a],null,null),g._37(335544320,10,{_mainButton:0}),g._37(603979776,11,{_fabLists:1}),(n()(),g._40(-1,0,["\n            "])),(n()(),g._16(6,0,null,0,6,"button",[["ion-fab",""]],[[1,"aria-label",0]],[[null,"click"]],function(n,e,l){var t=!0;if("click"===e){t=!1!==n.component.openEdit()&&t}return t},Mn.b,Mn.a)),g._15(7,49152,[[10,4]],0,Rn.a,[tn.a,g.p,g.K],null,null),g._32(131072,rn.a,[on.a,g.i]),(n()(),g._40(-1,0,["\n                "])),(n()(),g._16(10,0,null,0,1,"ion-icon",[["name","add"],["role","img"]],[[2,"hide",null]],null,null,null,null)),g._15(11,147456,null,0,ln.a,[tn.a,g.p,g.K],{name:[0,"name"]},null),(n()(),g._40(-1,0,["\n            "])),(n()(),g._40(-1,0,["\n        "]))],function(n,e){n(e,1,0);n(e,11,0,"add")},function(n,e){n(e,6,0,g._41(e,6,0,g._29(e,8).transform("addon.calendar.newevent")));n(e,10,0,g._29(e,11)._hidden)})}function E(n){return g._42(0,[g._32(0,Vn.a,[Tn.a,A.a]),g._37(402653184,1,{content:0}),g._37(402653184,2,{splitviewCtrl:0}),(n()(),g._16(3,0,null,null,32,"ion-header",[],null,null,null,null,null)),g._15(4,16384,null,0,Un.a,[tn.a,g.p,g.K,[2,Hn.a]],null,null),(n()(),g._40(-1,null,["\n    "])),(n()(),g._16(6,0,null,null,28,"ion-navbar",[["class","toolbar"],["core-back-button",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,Fn.b,Fn.a)),g._15(7,49152,null,0,Yn.a,[jn.a,[2,Hn.a],[2,Ln.a],tn.a,g.p,g.K],null,null),g._15(8,212992,null,0,zn.a,[Yn.a,Cn.a,on.a,$.a],null,null),(n()(),g._40(-1,3,["\n        "])),(n()(),g._16(10,0,null,3,3,"ion-title",[],null,null,null,Bn.b,Bn.a)),g._15(11,49152,null,0,Gn.a,[tn.a,g.p,g.K,[2,Jn.a],[2,Yn.a]],null,null),(n()(),g._40(12,0,["",""])),g._32(131072,rn.a,[on.a,g.i]),(n()(),g._40(-1,3,["\n        "])),(n()(),g._16(15,0,null,2,18,"ion-buttons",[["end",""]],null,null,null,null,null)),g._15(16,16384,null,1,qn.a,[tn.a,g.p,g.K,[2,Jn.a],[2,Yn.a]],null,null),g._37(603979776,3,{_buttons:1}),(n()(),g._40(-1,null,["\n            "])),(n()(),g._11(16777216,null,null,1,null,a)),g._15(20,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,null,["\n            "])),(n()(),g._16(22,0,null,null,10,"core-context-menu",[],null,null,null,Qn.b,Qn.a)),g._15(23,245760,null,0,Xn.a,[on.a,Zn.a,g.p,S.a,[2,ne.a],k.a],null,null),(n()(),g._40(-1,0,["\n                "])),(n()(),g._16(25,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.openSettings()&&t}return t},ee.b,ee.a)),g._15(26,770048,null,0,le.a,[Xn.a],{content:[0,"content"],iconAction:[1,"iconAction"],priority:[2,"priority"],hidden:[3,"hidden"]},{action:"action"}),g._32(131072,rn.a,[on.a,g.i]),(n()(),g._40(-1,0,["\n                "])),(n()(),g._16(29,0,null,0,2,"core-context-menu-item",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.doRefresh(null,l,!0)&&t}return t},ee.b,ee.a)),g._15(30,770048,null,0,le.a,[Xn.a],{content:[0,"content"],iconAction:[1,"iconAction"],closeOnClick:[2,"closeOnClick"],priority:[3,"priority"],hidden:[4,"hidden"]},{action:"action"}),g._32(131072,rn.a,[on.a,g.i]),(n()(),g._40(-1,0,["\n            "])),(n()(),g._40(-1,null,["\n        "])),(n()(),g._40(-1,3,["\n    "])),(n()(),g._40(-1,null,["\n"])),(n()(),g._40(-1,null,["\n"])),(n()(),g._16(37,0,null,null,35,"core-split-view",[],null,null,null,te.b,te.a)),g._15(38,245760,[[2,4]],0,W.a,[[2,Ln.a],g.p,ie.a,Cn.a,on.a],null,null),(n()(),g._40(-1,0,["\n    "])),(n()(),g._16(40,0,null,0,31,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,ae.b,ae.a)),g._15(41,4374528,[[1,4]],0,Sn.a,[tn.a,Cn.a,Pn.a,g.p,g.K,jn.a,ue.a,g.D,[2,Hn.a],[2,Ln.a]],null,null),(n()(),g._40(-1,1,["\n        "])),(n()(),g._16(43,0,null,2,6,"ion-refresher",[],[[2,"refresher-active",null],[4,"top",null]],[[null,"ionRefresh"]],function(n,e,l){var t=!0;if("ionRefresh"===e){t=!1!==n.component.doRefresh(l)&&t}return t},null,null)),g._15(44,212992,null,0,re.a,[Cn.a,Sn.a,g.D,Nn.l],{enabled:[0,"enabled"]},{ionRefresh:"ionRefresh"}),(n()(),g._40(-1,null,["\n            "])),(n()(),g._16(46,0,null,null,2,"ion-refresher-content",[],[[1,"state",0]],null,null,oe.b,oe.a)),g._15(47,114688,null,0,se.a,[re.a,tn.a],{pullingText:[0,"pullingText"]},null),g._32(131072,rn.a,[on.a,g.i]),(n()(),g._40(-1,null,["\n        "])),(n()(),g._40(-1,1,["\n        "])),(n()(),g._16(51,0,null,1,15,"core-loading",[],null,null,null,ce.b,ce.a)),g._15(52,638976,null,0,de.a,[on.a,g.p,$.a,k.a],{hideUntil:[0,"hideUntil"]},null),(n()(),g._40(-1,0,["\n            "])),(n()(),g._40(-1,0,["\n            "])),(n()(),g._11(16777216,null,0,1,null,u)),g._15(56,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,0,["\n\n            "])),(n()(),g._11(16777216,null,0,1,null,r)),g._15(59,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,0,["\n\n            "])),(n()(),g._11(16777216,null,0,1,null,p)),g._15(62,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,0,["\n\n            "])),(n()(),g._16(64,0,null,0,1,"core-infinite-loading",[],null,[[null,"action"]],function(n,e,l){var t=!0;if("action"===e){t=!1!==n.component.loadMoreEvents(l)&&t}return t},_e.b,_e.a)),g._15(65,573440,null,0,fe.a,[[2,Sn.a],S.a],{enabled:[0,"enabled"],error:[1,"error"]},{action:"action"}),(n()(),g._40(-1,0,["\n        "])),(n()(),g._40(-1,1,["\n\n        "])),(n()(),g._40(-1,1,["\n        "])),(n()(),g._11(16777216,null,0,1,null,m)),g._15(70,16384,null,0,sn.k,[g.W,g.T],{ngIf:[0,"ngIf"]},null),(n()(),g._40(-1,1,["\n    "])),(n()(),g._40(-1,0,["\n"]))],function(n,e){var l=e.component;n(e,8,0);n(e,20,0,l.courses&&l.courses.length),n(e,23,0);n(e,26,0,g._41(e,26,0,g._29(e,27).transform("core.settings.settings")),"cog",600,!l.notificationsEnabled);n(e,30,0,g._41(e,30,0,g._29(e,31).transform("core.settings.synchronizenow")),l.syncIcon,!1,400,!l.eventsLoaded||!l.hasOffline||!l.isOnline),n(e,38,0);n(e,44,0,l.eventsLoaded);n(e,47,0,g._19(1,"",g._41(e,47,0,g._29(e,48).transform("core.pulltorefresh")),""));n(e,52,0,l.eventsLoaded);n(e,56,0,l.hasOffline);n(e,59,0,!l.filteredEvents||!l.filteredEvents.length);n(e,62,0,l.filteredEvents&&l.filteredEvents.length);n(e,65,0,l.canLoadMore,l.loadMoreError);n(e,70,0,l.canCreate)},function(n,e){n(e,6,0,g._29(e,7)._hidden,g._29(e,7)._sbPadding);n(e,12,0,g._41(e,12,0,g._29(e,13).transform("addon.calendar.calendarevents")));n(e,40,0,g._29(e,41).statusbarPadding,g._29(e,41)._hasRefresher);n(e,43,0,"inactive"!==g._29(e,44).state,g._29(e,44)._top);n(e,46,0,g._29(e,47).r.state)})}Object.defineProperty(e,"__esModule",{value:!0});var g=l(1),I=(l(0),l(7),l(4)),b=l(30),y=l(32),O=l(110),C=l(214),D=l(367),T=l(473),x=l(476),w=l(52),L=l(184),S=l(5),A=l(25),k=l(3),N=l(2),P=l(155),$=l(12),K=l(10),W=l(26),M=l(16),R=l(213),V=l(41),U=function(){function n(n,e,l,t,i,a,u,r,o,s,c,d,_,f,h,v,p){var m=this;this.calendarProvider=n,this.domUtils=l,this.coursesProvider=t,this.utils=i,this.calendarHelper=a,this.coursesHelper=s,this.eventsProvider=c,this.navCtrl=d,this.appProvider=_,this.calendarOffline=f,this.calendarSync=h,this.timeUtils=p,this.initialTime=0,this.daysLoaded=0,this.emptyEventsTimes=0,this.categoriesRetrieved=!1,this.getCategories=!1,this.categories={},this.onlineEvents=[],this.offlineEvents=[],this.deletedEvents=[],this.eventsLoaded=!1,this.events=[],this.notificationsEnabled=!1,this.filteredEvents=[],this.canLoadMore=!1,this.loadMoreError=!1,this.canCreate=!1,this.hasOffline=!1,this.isOnline=!1,this.siteHomeId=u.getCurrentSite().getSiteHomeId(),this.notificationsEnabled=o.isAvailable(),this.currentSiteId=u.getCurrentSiteId(),this.notificationsEnabled&&(this.obsDefaultTimeChange=c.on(C.a.DEFAULT_NOTIFICATION_TIME_CHANGED,function(){n.scheduleEventsNotifications(m.onlineEvents)},this.currentSiteId)),this.eventId=e.get("eventId")||!1,this.courseId=e.get("courseId"),this.newEventObserver=c.on(C.a.NEW_EVENT_EVENT,function(n){n&&n.event&&(m.splitviewCtrl.isOn()&&m.splitviewCtrl.emptyDetails(),m.eventsLoaded=!1,m.refreshEvents(!0,!1).finally(function(){m.splitviewCtrl.isOn()&&n.event.id>0&&m.gotoEvent(n.event.id)}))},this.currentSiteId),this.discardedObserver=c.on(C.a.NEW_EVENT_DISCARDED_EVENT,function(){m.splitviewCtrl.isOn()&&m.splitviewCtrl.emptyDetails(),m.eventsLoaded=!1,m.refreshEvents(!0,!1)},this.currentSiteId),this.editEventObserver=c.on(C.a.EDIT_EVENT_EVENT,function(n){n&&n.event&&(m.eventsLoaded=!1,m.refreshEvents(!0,!1))},this.currentSiteId),this.syncObserver=c.on(x.a.AUTO_SYNCED,function(n){m.eventsLoaded=!1,m.refreshEvents(),m.splitviewCtrl.isOn()&&m.eventId&&n&&n.deleted&&-1!=n.deleted.indexOf(m.eventId)&&m.splitviewCtrl.emptyDetails()},this.currentSiteId),this.manualSyncObserver=c.on(x.a.MANUAL_SYNCED,function(n){n&&"list"!=n.source&&(m.eventsLoaded=!1,m.refreshEvents()),m.splitviewCtrl.isOn()&&m.eventId&&n&&n.deleted&&-1!=n.deleted.indexOf(m.eventId)&&m.splitviewCtrl.emptyDetails()},this.currentSiteId),this.deleteEventObserver=c.on(C.a.DELETED_EVENT_EVENT,function(n){n&&!n.sent?(m.markAsDeleted(n.eventId,!0),m.deletedEvents.push(n.eventId),m.hasOffline=!0):(m.splitviewCtrl.isOn()&&m.splitviewCtrl.emptyDetails(),m.eventsLoaded=!1,m.refreshEvents())},this.currentSiteId),this.undeleteEventObserver=c.on(C.a.UNDELETED_EVENT_EVENT,function(n){if(n&&n.eventId){m.markAsDeleted(n.eventId,!1);var e=m.deletedEvents.indexOf(n.eventId);-1!=e&&m.deletedEvents.splice(e,1),m.hasOffline=!!m.offlineEvents.length||!!m.deletedEvents.length}},this.currentSiteId),this.onlineObserver=v.onchange().subscribe(function(){r.run(function(){m.isOnline=m.appProvider.isOnline()})})}return n.prototype.ionViewDidLoad=function(){var n=this;this.eventId&&this.gotoEvent(this.eventId),this.syncIcon="spinner",this.fetchData(!1,!0,!1).then(function(){!n.eventId&&n.splitviewCtrl.isOn()&&n.events.length>0&&n.gotoEvent(n.onlineEvents[0]?n.onlineEvents[0].id:n.offlineEvents[0].id)})},n.prototype.fetchData=function(n,e,l){var t=this;this.initialTime=this.timeUtils.timestamp(),this.daysLoaded=0,this.emptyEventsTimes=0,this.isOnline=this.appProvider.isOnline();return(e?this.calendarSync.syncEvents().then(function(n){n.warnings&&n.warnings.length&&t.domUtils.showErrorModal(n.warnings[0]),n.updated&&(n.source="list",t.eventsProvider.trigger(x.a.MANUAL_SYNCED,n,t.currentSiteId))}).catch(function(n){l&&t.domUtils.showErrorModalDefault(n,"core.errorsync",!0)}):Promise.resolve()).then(function(){var e=[];return t.hasOffline=!1,e.push(t.calendarHelper.canEditEvents(t.courseId).then(function(n){t.canCreate=n})),e.push(t.coursesHelper.getCoursesForPopover(t.courseId).then(function(e){return t.courses=e.courses,t.categoryId=e.categoryId,t.fetchEvents(n)})),e.push(t.calendarOffline.getAllEditedEvents().then(function(n){t.hasOffline=t.hasOffline||!!n.length,n.forEach(function(n){n.offline=!0,t.calendarHelper.formatEventData(n)}),t.offlineEvents=t.sortEvents(n)})),e.push(t.calendarOffline.getAllDeletedEventsIds().then(function(n){t.hasOffline=t.hasOffline||!!n.length,t.deletedEvents=n})),Promise.all(e)}).finally(function(){t.eventsLoaded=!0,t.syncIcon="sync"})},n.prototype.fetchEvents=function(n){var e=this;return this.loadMoreError=!1,this.calendarProvider.getEventsList(this.initialTime,this.daysLoaded,C.a.DAYS_INTERVAL).then(function(l){if(0===l.length){if(e.emptyEventsTimes++,!(e.emptyEventsTimes>5))return e.daysLoaded+=C.a.DAYS_INTERVAL,e.fetchEvents();e.canLoadMore=!1,n&&(e.onlineEvents=[],e.filteredEvents=[],e.events=e.offlineEvents)}else{l.forEach(e.calendarHelper.formatEventData.bind(e.calendarHelper));var t=e.mergeEvents(l);e.getCategories=e.shouldLoadCategories(l),n?(e.onlineEvents=l,e.events=t):(e.onlineEvents=e.utils.mergeArraysWithoutDuplicates(e.onlineEvents,l,"id"),e.events=e.utils.mergeArraysWithoutDuplicates(e.events,t,"id")),e.filteredEvents=e.getFilteredEvents(),e.filteredEvents.forEach(function(n,l){n.showDate=e.showDate(n,e.filteredEvents[l-1]),n.endsSameDay=e.endsSameDay(n)}),e.canLoadMore=!0,e.calendarProvider.scheduleEventsNotifications(e.onlineEvents),e.daysLoaded+=C.a.DAYS_INTERVAL}e.content.resize()}).catch(function(n){e.domUtils.showErrorModalDefault(n,"addon.calendar.errorloadevents",!0),e.loadMoreError=!0}).then(function(){if(e.getCategories)return e.getCategories=!1,e.loadCategories()})},n.prototype.loadMoreEvents=function(n){return this.fetchEvents().finally(function(){n&&n()})},n.prototype.getFilteredEvents=function(){var n=this;return this.courseId?this.events.filter(function(e){return n.calendarHelper.shouldDisplayEvent(e,n.courseId,n.categoryId,n.categories)}):this.events},n.prototype.shouldLoadCategories=function(n){if(this.categoriesRetrieved||this.getCategories)return this.getCategories;return n.some(function(n){return"undefined"!=n.categoryid&&n.categoryid>0})||this.getCategories},n.prototype.loadCategories=function(){var n=this;return this.coursesProvider.getCategories(0,!0).then(function(e){n.categoriesRetrieved=!0,n.categories={},e.forEach(function(e){n.categories[e.id]=e})}).catch(function(){})},n.prototype.mergeEvents=function(n){var e=this;if(!this.offlineEvents.length&&!this.deletedEvents.length)return n;var l=this.initialTime+V.a.SECONDS_DAY*this.daysLoaded,t=l+V.a.SECONDS_DAY*C.a.DAYS_INTERVAL-1,i=n;this.deletedEvents.length&&i.forEach(function(n){n.deleted=-1!=e.deletedEvents.indexOf(n.id)}),this.offlineEvents.length&&(i=i.filter(function(n){return!e.offlineEvents.find(function(e){return e.id==n.id})}));var a=this.offlineEvents.filter(function(n){return 0==e.daysLoaded&&n.timestart<l||(n.timestart>=l||n.timestart+n.timeduration>=l)&&n.timestart<=t});return i=i.concat(a),this.sortEvents(i)},n.prototype.sortEvents=function(n){return n.sort(function(n,e){return n.timestart==e.timestart?n.timeduration-e.timeduration:n.timestart-e.timestart})},n.prototype.doRefresh=function(n,e,l){return this.eventsLoaded?this.refreshEvents(!0,l).finally(function(){n&&n.complete(),e&&e()}):Promise.resolve()},n.prototype.refreshEvents=function(n,e){var l=this;this.syncIcon="spinner";var t=[];return t.push(this.calendarProvider.invalidateEventsList()),t.push(this.calendarProvider.invalidateAllowedEventTypes()),this.categoriesRetrieved&&(t.push(this.coursesProvider.invalidateCategories(0,!0)),this.categoriesRetrieved=!1),Promise.all(t).finally(function(){return l.fetchData(!0,n,e)})},n.prototype.showDate=function(n,e){return!e||!M(1e3*n.timestart).isSame(1e3*e.timestart,"day")},n.prototype.endsSameDay=function(n){return!n.timeduration||M(1e3*n.timestart).isSame(1e3*(n.timestart+n.timeduration),"day")},n.prototype.openCourseFilter=function(n){var e=this;this.coursesHelper.selectCourse(n,this.courses,this.courseId).then(function(n){void 0!==n.courseId&&(e.courseId=n.courseId>0?n.courseId:void 0,e.categoryId=n.courseId>0?n.categoryId:void 0,e.calendarHelper.canEditEvents(e.courseId).then(function(n){e.canCreate=n}),e.filteredEvents=e.getFilteredEvents(),e.domUtils.scrollToTop(e.content))})},n.prototype.openEdit=function(n){this.eventId=void 0;var e={};n&&(e.eventId=n),this.courseId&&(e.courseId=this.courseId),this.splitviewCtrl.push("AddonCalendarEditEventPage",e)},n.prototype.openSettings=function(){this.navCtrl.push("AddonCalendarSettingsPage")},n.prototype.gotoEvent=function(n){this.eventId=n,n<0?this.openEdit(n):this.splitviewCtrl.push("AddonCalendarEventPage",{id:n})},n.prototype.markAsDeleted=function(n,e){var l=this.onlineEvents.find(function(e){return e.id==n});l&&(l.deleted=e)},n.prototype.ngOnDestroy=function(){this.obsDefaultTimeChange&&this.obsDefaultTimeChange.off(),this.newEventObserver&&this.newEventObserver.off(),this.discardedObserver&&this.discardedObserver.off(),this.editEventObserver&&this.editEventObserver.off(),this.deleteEventObserver&&this.deleteEventObserver.off(),this.undeleteEventObserver&&this.undeleteEventObserver.off(),this.syncObserver&&this.syncObserver.off(),this.manualSyncObserver&&this.manualSyncObserver.off(),this.onlineObserver&&this.onlineObserver.unsubscribe()},n}(),H=function(){return function(){}}(),F=l(1471),Y=l(1472),j=l(1473),z=l(1474),B=l(1475),G=l(1476),J=l(1477),q=l(1478),Q=l(1479),X=l(1480),Z=l(1481),nn=l(1482),en=l(1483),ln=l(47),tn=l(8),an=l(45),un=l(43),rn=l(28),on=l(19),sn=l(9),cn=l(84),dn=l(122),_n=l(111),fn=l(31),hn=l(22),vn=l(21),pn=l(29),mn=l(94),En=l(112),gn=l(95),In=l(223),bn=l(33),yn=l(42),On=l(11),Cn=l(17),Dn=l(24),Tn=l(6),xn=l(18),wn=l(14),Ln=l(20),Sn=l(27),An=l(38),kn=l(83),Nn=l(40),Pn=l(34),$n=l(314),Kn=l(275),Wn=l(227),Mn=l(315),Rn=l(198),Vn=l(246),Un=l(365),Hn=l(39),Fn=l(713),Yn=l(209),jn=l(35),zn=l(471),Bn=l(714),Gn=l(307),Jn=l(245),qn=l(366),Qn=l(86),Xn=l(75),Zn=l(66),ne=l(73),ee=l(87),le=l(79),te=l(472),ie=l(69),ae=l(179),ue=l(102),re=l(152),oe=l(210),se=l(168),ce=l(51),de=l(48),_e=l(369),fe=l(270),he=l(72),ve=g._14({encapsulation:2,styles:[],data:{}}),pe=g._12("page-addon-calendar-list",U,function(n){return g._42(0,[(n()(),g._16(0,0,null,null,1,"page-addon-calendar-list",[],null,null,null,E,ve)),g._15(1,180224,null,0,U,[C.a,he.a,S.a,w.a,k.a,T.a,N.a,g.D,P.a,L.a,$.a,Ln.a,K.a,D.a,x.a,R.a,A.a],null,null)],null,null)},{},{},[]),me=l(23),Ee=l(361),ge=l(362),Ie=l(364),be=l(363),ye=l(470),Oe=l(712),Ce=l(268);l.d(e,"AddonCalendarListPageModuleNgFactory",function(){return De});var De=g._13(H,[],function(n){return g._25([g._26(512,g.n,g._6,[[8,[F.a,Y.a,j.a,z.a,B.a,G.a,J.a,q.a,Q.a,X.a,Z.a,nn.a,en.a,pe]],[3,g.n],g.B]),g._26(4608,sn.m,sn.l,[g.x,[2,sn.w]]),g._26(4608,me.x,me.x,[]),g._26(4608,me.d,me.d,[]),g._26(4608,Ee.b,Ee.a,[]),g._26(4608,ge.a,ge.b,[]),g._26(4608,Ie.b,Ie.a,[]),g._26(4608,be.b,be.a,[]),g._26(4608,on.a,on.a,[ye.a,Ee.b,ge.a,Ie.b,be.b,on.b,on.c]),g._26(512,sn.b,sn.b,[]),g._26(512,me.v,me.v,[]),g._26(512,me.i,me.i,[]),g._26(512,me.s,me.s,[]),g._26(512,Oe.a,Oe.a,[]),g._26(512,I.a,I.a,[]),g._26(512,y.a,y.a,[]),g._26(512,O.a,O.a,[]),g._26(512,b.a,b.a,[]),g._26(512,Oe.b,Oe.b,[]),g._26(512,H,H,[]),g._26(256,on.c,void 0,[]),g._26(256,on.b,void 0,[]),g._26(256,Ce.a,U,[])])})}});